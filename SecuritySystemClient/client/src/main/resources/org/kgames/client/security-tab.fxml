<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.image.ImageView?>

<SplitPane xmlns:fx="http://javafx.com/fxml"
           fx:controller="org.kgames.client.controller.SecurityTabController"
           dividerPositions="0.5" orientation="HORIZONTAL" 
           style="-fx-background-color: #2d2d2d; -fx-border-color: #404040;">
  
  <!-- Left Side: Camera Feeds -->
  <VBox spacing="10" minWidth="100" prefWidth="400" maxWidth="-1" VBox.vgrow="ALWAYS" 
        style="-fx-background-color: #2d2d2d;">
    <padding>
      <Insets top="15" right="15" bottom="15" left="15"/>
    </padding>
    <Label text="Camera Feeds" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #ffffff;"/>
    
    <!-- Camera Feed Container - uses grid layout for 2x2 camera positioning -->
    <ScrollPane fx:id="cameraScrollPane" VBox.vgrow="ALWAYS" fitToWidth="true" fitToHeight="true"
                hbarPolicy="NEVER" vbarPolicy="NEVER"
                style="-fx-background-color: #1e1e1e; -fx-border-color: #404040; -fx-border-width: 1px;">
      <GridPane fx:id="cameraFeedsContainer" hgap="10" vgap="10" alignment="CENTER"
                style="-fx-background-color: #1e1e1e; -fx-padding: 10px;" />
    </ScrollPane>

    <!-- Camera Controls -->
    <VBox spacing="8">
      <Label text="Camera Controls" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #e0e0e0;"/>
      
      <!-- Add Camera Button and Status -->
      <HBox spacing="12" alignment="CENTER_LEFT">
        <Button fx:id="addCameraButton" text="Add Camera" onAction="#onAddCameraButtonClick"
                styleClass="button,primary" 
                prefWidth="140" prefHeight="32"
                minWidth="140" minHeight="32"/>
        <Label fx:id="cameraStatusLabel" text="Ready to add cameras" styleClass="label,caption"/>
      </HBox>
    </VBox>
  </VBox>
  
  <!-- Right Side: Access Logs and Sensors -->
  <VBox spacing="10" minWidth="100" prefWidth="400" maxWidth="-1" VBox.vgrow="ALWAYS" 
        style="-fx-background-color: #2d2d2d;">
    <padding>
      <Insets top="15" right="15" bottom="15" left="15"/>
    </padding>
    <Label text="Access Logs" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #ffffff;"/>
    
    <!-- Access Log Filter Controls Section -->
    <VBox spacing="8" styleClass="card">
      <padding>
        <Insets top="10" right="10" bottom="10" left="10"/>
      </padding>
      <Label text="Filter Logs" styleClass="label,subtitle"/>
      
      <!-- Filter Controls Row -->
      <HBox spacing="8" alignment="CENTER_LEFT">
        <!-- Search Bar -->
        <VBox spacing="3" HBox.hgrow="ALWAYS">
          <Label text="Search:" styleClass="label,caption"/>
          <TextField fx:id="accessLogSearchField" promptText="Search by user or reason..." 
                     prefWidth="150" onKeyReleased="#onAccessLogSearchChanged" styleClass="search-field"/>
        </VBox>
        
        <!-- Access Result Filter -->
        <VBox spacing="3">
          <Label text="Result:" styleClass="label,caption"/>
          <ComboBox fx:id="accessResultFilterComboBox" prefWidth="90" promptText="All"
                    onAction="#onAccessResultFilterChanged"/>
        </VBox>
        
        <!-- Time Range Filter -->
        <VBox spacing="3">
          <Label text="Time:" styleClass="label,caption"/>
          <ComboBox fx:id="timeRangeFilterComboBox" prefWidth="100" promptText="All Time"
                    onAction="#onTimeRangeFilterChanged"/>
        </VBox>
        
        <!-- Clear Filters Button -->
        <VBox spacing="3">
          <Label text=" " styleClass="label,caption"/>
          <Button fx:id="clearAccessLogFiltersButton" text="Clear" onAction="#onClearAccessLogFilters"
                  styleClass="button,secondary" prefHeight="28" prefWidth="50"/>
        </VBox>
      </HBox>
      
      <!-- Filter Status -->
      <HBox spacing="8" alignment="CENTER_LEFT">
        <Label fx:id="accessLogFilterStatusLabel" text="Showing all logs" styleClass="label,caption"/>
        <Label fx:id="accessLogCountLabel" text="(0 logs)" styleClass="label,caption"/>
      </HBox>
      
      <!-- Pagination Controls -->
      <HBox spacing="8" alignment="CENTER_LEFT">
        <Button fx:id="previousPageButton" text="← Previous" onAction="#onPreviousPage"
                styleClass="button,secondary" prefHeight="28" prefWidth="80" disable="true"/>
        <Label fx:id="pageInfoLabel" text="Page 1" styleClass="label,caption"/>
        <Button fx:id="nextPageButton" text="Next →" onAction="#onNextPage"
                styleClass="button,secondary" prefHeight="28" prefWidth="80" disable="true"/>
      </HBox>
    </VBox>
    
    <TableView fx:id="accessLogTable" prefHeight="200" VBox.vgrow="ALWAYS" styleClass="access-log-table"
               maxWidth="Infinity">
      <columns>
        <TableColumn fx:id="timeColumn" text="Time" prefWidth="140" minWidth="100"/>
        <TableColumn fx:id="userColumn" text="User" prefWidth="120" minWidth="80"/>
        <TableColumn fx:id="actionColumn" text="Action" prefWidth="240" minWidth="150"/>
      </columns>
      <columnResizePolicy>
        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
      </columnResizePolicy>
    </TableView>
    
    <!-- Combined Alarm Control and Sensor Status Section -->
    <HBox spacing="10" VBox.vgrow="ALWAYS">
      <!-- Alarm Control Section -->
      <VBox spacing="6" styleClass="card" prefWidth="160" maxWidth="160" minWidth="160">
        <padding>
          <Insets top="8" right="8" bottom="8" left="8"/>
        </padding>
        
        <Label text="Alarm Control" styleClass="label,subtitle"/>
        
        <!-- Status Display -->
        <VBox spacing="3">
          <HBox spacing="4" alignment="CENTER_LEFT">
            <Label text="Status:" styleClass="label,caption" style="-fx-font-size: 10px;"/>
            <Label fx:id="alarmStatusLabel" text="Ready" styleClass="label,bold" 
                   style="-fx-text-fill: #4CAF50; -fx-font-size: 10px;"/>
          </HBox>
          <Label fx:id="alarmMessageLabel" text="System ready" styleClass="label,caption" 
                 wrapText="true" style="-fx-font-size: 9px;"/>
          <Label fx:id="alarmCountdownLabel" text="" styleClass="label,caption" 
                 style="-fx-text-fill: #ff9800; -fx-font-size: 9px;" visible="false" wrapText="true"/>
        </VBox>
        
        <!-- Control Buttons -->
        <VBox spacing="4" VBox.vgrow="ALWAYS">
          <Button fx:id="activateAlarmButton" text="Activate Alarm" onAction="#onActivateAlarmClick"
                  styleClass="button,danger" prefWidth="140" prefHeight="28" maxWidth="140"/>
          <Button fx:id="disableAlarmButton" text="Disable Alarm" onAction="#onDisableAlarmClick"
                  styleClass="button,secondary" prefWidth="140" prefHeight="28" maxWidth="140" disable="true"/>
        </VBox>
      </VBox>
      
      <!-- Sensor Status Section -->
      <VBox spacing="6" HBox.hgrow="ALWAYS">
        <Label text="Sensor Status" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #e0e0e0;"/>
        <ListView fx:id="sensorStatusList" prefHeight="120" VBox.vgrow="ALWAYS"/>
      </VBox>
    </HBox>
  </VBox>
</SplitPane>
